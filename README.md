This is legacy Python implementation.
